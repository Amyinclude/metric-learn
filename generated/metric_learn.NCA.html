

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>metric_learn.NCA &mdash; metric-learn 0.6.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/js/copybutton.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="metric_learn.RCA" href="metric_learn.RCA.html" />
    <link rel="prev" title="metric_learn.MLKR" href="metric_learn.MLKR.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> metric-learn
          

          
          </a>

          
            
            
              <div class="version">
                0.6.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_guide.html">User Guide</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../metric_learn.html">Package Contents</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../metric_learn.html#module-contents">Module Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metric_learn.html#base-classes">Base Classes</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../metric_learn.html#supervised-learning-algorithms">Supervised Learning Algorithms</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="metric_learn.LFDA.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">metric_learn</span></code>.LFDA</a></li>
<li class="toctree-l3"><a class="reference internal" href="metric_learn.LMNN.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">metric_learn</span></code>.LMNN</a></li>
<li class="toctree-l3"><a class="reference internal" href="metric_learn.MLKR.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">metric_learn</span></code>.MLKR</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">metric_learn</span></code>.NCA</a></li>
<li class="toctree-l3"><a class="reference internal" href="metric_learn.RCA.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">metric_learn</span></code>.RCA</a></li>
<li class="toctree-l3"><a class="reference internal" href="metric_learn.ITML_Supervised.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">metric_learn</span></code>.ITML_Supervised</a></li>
<li class="toctree-l3"><a class="reference internal" href="metric_learn.LSML_Supervised.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">metric_learn</span></code>.LSML_Supervised</a></li>
<li class="toctree-l3"><a class="reference internal" href="metric_learn.MMC_Supervised.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">metric_learn</span></code>.MMC_Supervised</a></li>
<li class="toctree-l3"><a class="reference internal" href="metric_learn.SDML_Supervised.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">metric_learn</span></code>.SDML_Supervised</a></li>
<li class="toctree-l3"><a class="reference internal" href="metric_learn.RCA_Supervised.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">metric_learn</span></code>.RCA_Supervised</a></li>
<li class="toctree-l3"><a class="reference internal" href="metric_learn.SCML_Supervised.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">metric_learn</span></code>.SCML_Supervised</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../metric_learn.html#weakly-supervised-learning-algorithms">Weakly Supervised Learning Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metric_learn.html#unsupervised-learning-algorithms">Unsupervised Learning Algorithms</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">Examples</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">metric-learn</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../metric_learn.html">metric_learn package</a> &raquo;</li>
        
      <li><code class="xref py py-mod docutils literal notranslate"><span class="pre">metric_learn</span></code>.NCA</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/generated/metric_learn.NCA.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="metric-learn-nca">
<h1><code class="xref py py-mod docutils literal notranslate"><span class="pre">metric_learn</span></code>.NCA<a class="headerlink" href="#metric-learn-nca" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="metric_learn.NCA">
<em class="property">class </em><code class="descclassname">metric_learn.</code><code class="descname">NCA</code><span class="sig-paren">(</span><em><span class="n">init</span><span class="o">=</span><span class="default_value">'auto'</span></em>, <em><span class="n">n_components</span><span class="o">=</span><span class="default_value">None</span></em>, <em><span class="n">max_iter</span><span class="o">=</span><span class="default_value">100</span></em>, <em><span class="n">tol</span><span class="o">=</span><span class="default_value">None</span></em>, <em><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em><span class="n">preprocessor</span><span class="o">=</span><span class="default_value">None</span></em>, <em><span class="n">random_state</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/metric_learn/nca.html#NCA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#metric_learn.NCA" title="Permalink to this definition">¶</a></dt>
<dd><p>Neighborhood Components Analysis (NCA)</p>
<p>NCA is a distance metric learning algorithm which aims to improve the
accuracy of nearest neighbors classification compared to the standard
Euclidean distance. The algorithm directly maximizes a stochastic variant
of the leave-one-out k-nearest neighbors(KNN) score on the training set.
It can also learn a low-dimensional linear transformation of data that can
be used for data visualization and fast classification.</p>
<p>Read more in the <a class="reference internal" href="../supervised.html#nca"><span class="std std-ref">User Guide</span></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>init</strong><span class="classifier">string or numpy array, optional (default=’auto’)</span></dt><dd><p>Initialization of the linear transformation. Possible options are
‘auto’, ‘pca’, ‘identity’, ‘random’, and a numpy array of shape
(n_features_a, n_features_b).</p>
<dl class="docutils">
<dt>‘auto’</dt><dd><p>Depending on <code class="docutils literal notranslate"><span class="pre">n_components</span></code>, the most reasonable initialization
will be chosen. If <code class="docutils literal notranslate"><span class="pre">n_components</span> <span class="pre">&lt;=</span> <span class="pre">n_classes</span></code> we use ‘lda’, as
it uses labels information. If not, but
<code class="docutils literal notranslate"><span class="pre">n_components</span> <span class="pre">&lt;</span> <span class="pre">min(n_features,</span> <span class="pre">n_samples)</span></code>, we use ‘pca’, as
it projects data in meaningful directions (those of higher
variance). Otherwise, we just use ‘identity’.</p>
</dd>
<dt>‘pca’</dt><dd><p><code class="docutils literal notranslate"><span class="pre">n_components</span></code> principal components of the inputs passed
to <a class="reference internal" href="#metric_learn.NCA.fit" title="metric_learn.NCA.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a> will be used to initialize the transformation.
(See <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html#sklearn.decomposition.PCA" title="(in scikit-learn v0.23)"><code class="xref any docutils literal notranslate"><span class="pre">sklearn.decomposition.PCA</span></code></a>)</p>
</dd>
<dt>‘lda’</dt><dd><p><code class="docutils literal notranslate"><span class="pre">min(n_components,</span> <span class="pre">n_classes)</span></code> most discriminative
components of the inputs passed to <a class="reference internal" href="#metric_learn.NCA.fit" title="metric_learn.NCA.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a> will be used to
initialize the transformation. (If <code class="docutils literal notranslate"><span class="pre">n_components</span> <span class="pre">&gt;</span> <span class="pre">n_classes</span></code>,
the rest of the components will be zero.) (See
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.discriminant_analysis.LinearDiscriminantAnalysis.html#sklearn.discriminant_analysis.LinearDiscriminantAnalysis" title="(in scikit-learn v0.23)"><code class="xref any docutils literal notranslate"><span class="pre">sklearn.discriminant_analysis.LinearDiscriminantAnalysis</span></code></a>)</p>
</dd>
<dt>‘identity’</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">n_components</span></code> is strictly smaller than the
dimensionality of the inputs passed to <a class="reference internal" href="#metric_learn.NCA.fit" title="metric_learn.NCA.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a>, the identity
matrix will be truncated to the first <code class="docutils literal notranslate"><span class="pre">n_components</span></code> rows.</p>
</dd>
<dt>‘random’</dt><dd><p>The initial transformation will be a random array of shape
<code class="xref any docutils literal notranslate"><span class="pre">(n_components,</span> <span class="pre">n_features)</span></code>. Each value is sampled from the
standard normal distribution.</p>
</dd>
<dt>numpy array</dt><dd><p>n_features_b must match the dimensionality of the inputs passed to
<a class="reference internal" href="#metric_learn.NCA.fit" title="metric_learn.NCA.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a> and n_features_a must be less than or equal to that.
If <code class="docutils literal notranslate"><span class="pre">n_components</span></code> is not None, n_features_a must match it.</p>
</dd>
</dl>
</dd>
<dt><strong>n_components</strong><span class="classifier">int or None, optional (default=None)</span></dt><dd><p>Dimensionality of reduced space (if None, defaults to dimension of X).</p>
</dd>
<dt><strong>max_iter</strong><span class="classifier">int, optional (default=100)</span></dt><dd><p>Maximum number of iterations done by the optimization algorithm.</p>
</dd>
<dt><strong>tol</strong><span class="classifier">float, optional (default=None)</span></dt><dd><p>Convergence tolerance for the optimization.</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">bool, optional (default=False)</span></dt><dd><p>Whether to print progress messages or not.</p>
</dd>
<dt><strong>random_state</strong><span class="classifier">int or numpy.RandomState or None, optional (default=None)</span></dt><dd><p>A pseudo random number generator object or a seed for it if int. If
<code class="docutils literal notranslate"><span class="pre">init='random'</span></code>, <code class="docutils literal notranslate"><span class="pre">random_state</span></code> is used to initialize the random
transformation. If <code class="docutils literal notranslate"><span class="pre">init='pca'</span></code>, <code class="docutils literal notranslate"><span class="pre">random_state</span></code> is passed as an
argument to PCA when initializing the transformation.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r268528307596-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>J. Goldberger, G. Hinton, S. Roweis, R. Salakhutdinov. <a class="reference external" href="http://www.cs.nyu.edu/~roweis/papers/ncanips.pdf">Neighbourhood
Components Analysis</a>.
NIPS 2005.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r268528307596-2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td>Wikipedia entry on <a class="reference external" href="https://en.wikipedia.org/wiki/Neighbourhood_components_analysis">Neighborhood Components Analysis</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">metric_learn</span> <span class="kn">import</span> <span class="n">NCA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iris_data</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">iris_data</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">iris_data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nca</span> <span class="o">=</span> <span class="n">NCA</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>n_iter_</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><code class="xref any docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The number of iterations the solver has run.</p>
</dd>
<dt><strong>components_</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref any docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>, shape=(n_components, n_features)</span></dt><dd><p>The learned linear transformation <code class="docutils literal notranslate"><span class="pre">L</span></code>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils align-default">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#metric_learn.NCA.fit" title="metric_learn.NCA.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>(self,&nbsp;X,&nbsp;y)</td>
<td>X: data matrix, (n x d) y: scalar labels, (n)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#metric_learn.NCA.fit_transform" title="metric_learn.NCA.fit_transform"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_transform</span></code></a>(self,&nbsp;X[,&nbsp;y])</td>
<td>Fit to data, then transform it.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#metric_learn.NCA.get_mahalanobis_matrix" title="metric_learn.NCA.get_mahalanobis_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_mahalanobis_matrix</span></code></a>(self)</td>
<td>Returns a copy of the Mahalanobis matrix learned by the metric learner.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#metric_learn.NCA.get_metric" title="metric_learn.NCA.get_metric"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_metric</span></code></a>(self)</td>
<td>Returns a function that takes as input two 1D arrays and outputs the learned metric score on these two points.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#metric_learn.NCA.get_params" title="metric_learn.NCA.get_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_params</span></code></a>(self[,&nbsp;deep])</td>
<td>Get parameters for this estimator.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#metric_learn.NCA.score_pairs" title="metric_learn.NCA.score_pairs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">score_pairs</span></code></a>(self,&nbsp;pairs)</td>
<td>Returns the learned Mahalanobis distance between pairs.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#metric_learn.NCA.set_params" title="metric_learn.NCA.set_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params</span></code></a>(self,&nbsp;**params)</td>
<td>Set the parameters of this estimator.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#metric_learn.NCA.transform" title="metric_learn.NCA.transform"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transform</span></code></a>(self,&nbsp;X)</td>
<td>Embeds data points in the learned linear embedding space.</td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="metric_learn.NCA.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em><span class="n">self</span></em>, <em><span class="n">init</span><span class="o">=</span><span class="default_value">'auto'</span></em>, <em><span class="n">n_components</span><span class="o">=</span><span class="default_value">None</span></em>, <em><span class="n">max_iter</span><span class="o">=</span><span class="default_value">100</span></em>, <em><span class="n">tol</span><span class="o">=</span><span class="default_value">None</span></em>, <em><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em><span class="n">preprocessor</span><span class="o">=</span><span class="default_value">None</span></em>, <em><span class="n">random_state</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/metric_learn/nca.html#NCA.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#metric_learn.NCA.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="py method">
<dt id="metric_learn.NCA.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em><span class="n">self</span></em>, <em><span class="n">X</span></em>, <em><span class="n">y</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/metric_learn/nca.html#NCA.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#metric_learn.NCA.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>X: data matrix, (n x d)
y: scalar labels, (n)</p>
</dd></dl>

<dl class="py method">
<dt id="metric_learn.NCA.fit_transform">
<code class="descname">fit_transform</code><span class="sig-paren">(</span><em><span class="n">self</span></em>, <em><span class="n">X</span></em>, <em><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em>, <em><span class="o">**</span><span class="n">fit_params</span></em><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.NCA.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit to data, then transform it.</p>
<p>Fits transformer to X and y with optional parameters fit_params
and returns a transformed version of X.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>X</strong><span class="classifier">{array-like, sparse matrix, dataframe} of shape                 (n_samples, n_features)</span></dt><dd></dd>
<dt><strong>y</strong><span class="classifier">ndarray of shape (n_samples,), default=None</span></dt><dd><p>Target values.</p>
</dd>
<dt><strong>**fit_params</strong><span class="classifier">dict</span></dt><dd><p>Additional fit parameters.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>X_new</strong><span class="classifier">ndarray array of shape (n_samples, n_features_new)</span></dt><dd><p>Transformed array.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="metric_learn.NCA.get_mahalanobis_matrix">
<code class="descname">get_mahalanobis_matrix</code><span class="sig-paren">(</span><em><span class="n">self</span></em><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.NCA.get_mahalanobis_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of the Mahalanobis matrix learned by the metric learner.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>M</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref any docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>, shape=(n_features, n_features)</span></dt><dd><p>The copy of the learned Mahalanobis matrix.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="metric_learn.NCA.get_metric">
<code class="descname">get_metric</code><span class="sig-paren">(</span><em><span class="n">self</span></em><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.NCA.get_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a function that takes as input two 1D arrays and outputs the
learned metric score on these two points.</p>
<p>This function will be independent from the metric learner that learned it
(it will not be modified if the initial metric learner is modified),
and it can be directly plugged into the <a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-metric" title="(in scikit-learn v0.23)"><code class="xref any docutils literal notranslate"><span class="pre">metric</span></code></a> argument of
scikit-learn’s estimators.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>metric_fun</strong><span class="classifier">function</span></dt><dd><p>The function described above.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#metric_learn.NCA.score_pairs" title="metric_learn.NCA.score_pairs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">score_pairs</span></code></a></dt><dd>a method that returns the metric score between several pairs of points. Unlike <a class="reference internal" href="#metric_learn.NCA.get_metric" title="metric_learn.NCA.get_metric"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">get_metric</span></code></a>, this is a method of the metric learner and therefore can change if the metric learner changes. Besides, it can use the metric learner’s preprocessor, and works on concatenated arrays.</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">metric_learn</span> <span class="kn">import</span> <span class="n">NCA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_classification</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nca</span> <span class="o">=</span> <span class="n">NCA</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_classification</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="n">nca</span><span class="o">.</span><span class="n">get_metric</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> 
<span class="go">KNeighborsClassifier(algorithm=&#39;auto&#39;, leaf_size=30,</span>
<span class="go">  metric=&lt;function MahalanobisMixin.get_metric.&lt;locals&gt;.metric_fun</span>
<span class="go">          at 0x...&gt;,</span>
<span class="go">  metric_params=None, n_jobs=None, n_neighbors=5, p=2,</span>
<span class="go">  weights=&#39;uniform&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="metric_learn.NCA.get_params">
<code class="descname">get_params</code><span class="sig-paren">(</span><em><span class="n">self</span></em>, <em><span class="n">deep</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.NCA.get_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Get parameters for this estimator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>deep</strong><span class="classifier">bool, default=True</span></dt><dd><p>If True, will return the parameters for this estimator and
contained subobjects that are estimators.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>params</strong><span class="classifier">mapping of string to any</span></dt><dd><p>Parameter names mapped to their values.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="metric_learn.NCA.score_pairs">
<code class="descname">score_pairs</code><span class="sig-paren">(</span><em><span class="n">self</span></em>, <em><span class="n">pairs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.NCA.score_pairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the learned Mahalanobis distance between pairs.</p>
<p>This distance is defined as: <span class="math notranslate nohighlight">\(d_M(x, x') = \sqrt{(x-x')^T M (x-x')}\)</span>
where <code class="docutils literal notranslate"><span class="pre">M</span></code> is the learned Mahalanobis matrix, for every pair of points
<code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">x'</span></code>. This corresponds to the euclidean distance between
embeddings of the points in a new space, obtained through a linear
transformation. Indeed, we have also: <span class="math notranslate nohighlight">\(d_M(x, x') = \sqrt{(x_e -
x_e')^T (x_e- x_e')}\)</span>, with <span class="math notranslate nohighlight">\(x_e = L x\)</span> (See
<code class="xref py py-class docutils literal notranslate"><span class="pre">MahalanobisMixin</span></code>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>pairs</strong><span class="classifier">array-like, shape=(n_pairs, 2, n_features) or (n_pairs, 2)</span></dt><dd><p>3D Array of pairs to score, with each row corresponding to two points,
for 2D array of indices of pairs if the metric learner uses a
preprocessor.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>scores</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref any docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of shape=(n_pairs,)</span></dt><dd><p>The learned Mahalanobis distance for every pair.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#metric_learn.NCA.get_metric" title="metric_learn.NCA.get_metric"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_metric</span></code></a></dt><dd>a method that returns a function to compute the metric between two points. The difference with <a class="reference internal" href="#metric_learn.NCA.score_pairs" title="metric_learn.NCA.score_pairs"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">score_pairs</span></code></a> is that it works on two 1D arrays and cannot use a preprocessor. Besides, the returned function is independent of the metric learner and hence is not modified if the metric learner is.</dd>
<dt><a class="reference internal" href="../introduction.html#mahalanobis-distances"><span class="std std-ref">Mahalanobis Distances</span></a></dt><dd>The section of the project documentation that describes Mahalanobis Distances.</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="metric_learn.NCA.set_params">
<code class="descname">set_params</code><span class="sig-paren">(</span><em><span class="n">self</span></em>, <em><span class="o">**</span><span class="n">params</span></em><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.NCA.set_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<p>The method works on simple estimators as well as on nested objects
(such as pipelines). The latter have parameters of the form
<code class="docutils literal notranslate"><span class="pre">&lt;component&gt;__&lt;parameter&gt;</span></code> so that it’s possible to update each
component of a nested object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>**params</strong><span class="classifier">dict</span></dt><dd><p>Estimator parameters.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>self</strong><span class="classifier">object</span></dt><dd><p>Estimator instance.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py method">
<dt id="metric_learn.NCA.transform">
<code class="descname">transform</code><span class="sig-paren">(</span><em><span class="n">self</span></em>, <em><span class="n">X</span></em><span class="sig-paren">)</span><a class="headerlink" href="#metric_learn.NCA.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Embeds data points in the learned linear embedding space.</p>
<p>Transforms samples in <code class="docutils literal notranslate"><span class="pre">X</span></code> into <code class="docutils literal notranslate"><span class="pre">X_embedded</span></code>, samples inside a new
embedding space such that: <code class="docutils literal notranslate"><span class="pre">X_embedded</span> <span class="pre">=</span> <span class="pre">X.dot(L.T)</span></code>, where <code class="docutils literal notranslate"><span class="pre">L</span></code> is
the learned linear transformation (See <code class="xref py py-class docutils literal notranslate"><span class="pre">MahalanobisMixin</span></code>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>X</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref any docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>, shape=(n_samples, n_features)</span></dt><dd><p>The data points to embed.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>X_embedded</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref any docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>, shape=(n_samples, n_components)</span></dt><dd><p>The embedded data points.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<div style='clear:both'></div></div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="metric_learn.RCA.html" class="btn btn-neutral float-right" title="metric_learn.RCA" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="metric_learn.MLKR.html" class="btn btn-neutral float-left" title="metric_learn.MLKR" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2015-2020, CJ Carey, Yuan Tang, William de Vazelhes, Aurélien Bellet and Nathalie Vauquier

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>